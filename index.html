<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
    <title>js-scheme - a Scheme interpreter written in JavaScript</title>
    <link rel="stylesheet" type="text/css" href="js-scheme.css?r=2" />
    <script type="text/javascript" src="libs/jquery-1.8.2.js"></script>
    <script type="text/javascript" src="libs/prototype.js"></script> <!--$ is now bound to prototype, not jQuery!-->
    <script type="text/javascript" src="js-scheme.js?r=51"></script>
    <script type="text/javascript" src="libs/last.fm/last.fm.js?r=1"></script>
    <script type="text/javascript" src="libs/flot/jquery.flot.pack.js"></script>
    <script type="text/javascript" src="libs/flot/flot.js"></script>
    <script type="text/javascript" src="libs/raphael-min.js"></script>
    <script type="text/javascript">
      window.onfocus = function() {
        document.getElementById('input').focus();
      };
    </script>


    <link rel="stylesheet" type="text/css" href="style.css" />
  </head>
  <body>

<script>

var paper = Raphael(500, 50, 3200, 500);

function draw_arrow(x1, y1, x2, y2) {
  var size = 5;
  var angle = Math.atan2(x1-x2,y2-y1);
  angle = (angle / (2 * Math.PI)) * 360;
  var arrowPath = paper.path("M" + x2 + " " + y2 + " L" + (x2 - size) + " " + (y2 - size) + " L" + (x2 - size) + " " + (y2 + size) + " L" + x2 + " " + y2 ).attr("fill","black").rotate((90+angle),x2,y2);
  var linePath = paper.path("M" + x1 + " " + y1 + " L" + x2 + " " + y2);
}


function draw_pair(p) {
  paper.clear();
  var subpairs = list_subpairs(p);

  function draw_subpair(p, x, y) {
    console.log("drawing", p)
    if (p.iden === undefined) {
      if (p.length === 0) {
        paper.text(x + 12, y + 12, "'()");
      } else {
        paper.text(x + 12, y + 12, p.toString());
      }
    } else {
      paper.rect(x,    y, 20, 20);
      paper.rect(x + 20, y, 20, 20);
      
      draw_subpair(p.car, x, y + 50);
      draw_arrow(x + 10, y + 10, x + 10 ,y + 50);

      draw_subpair(p.cdr, x + 90, y);
      draw_arrow(x + 30, y + 10, x + 90, y + 10);
    }
  }
  draw_subpair(subpairs, 10, 10);

}

</script>

    <div id="console">
      <h1><strong>JS-SCHEME</strong> -
      <script type="text/javascript">document.write(JSScheme.version)</script>
      -
      <script type="text/javascript">document.write(JSScheme.date)</script></h1>
      <div class="intro">
        <p>
          Welcome to JS-SCHEME!
        </p>
        <p>
          An extension of js-scheme that matches STk scheme functionality.  <br/>
          Original js-scheme by Erik Silkensen   <br/>
          Extensions by Pierre Karashchuk.
        </p>
        <p>
          Enter <span style="font-weight:bold;color:green;">(help)</span> for 
          more information.
        </p>
      </div>
    </div>
    <form onsubmit="jscm_repl(); return false;">
      <span id="prefix">&gt;&nbsp;</span>
      <input type="text" name="input" id="input" />
    </form>
    <div style="height:20em" onclick="$('input').focus()"></div>
  </body>
</html>
